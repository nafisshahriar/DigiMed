{% extends 'base.html' %}
{% load static %}

{% block title %}DigiMed - Your Health Partner{% endblock %}

{% block full_width_content %}
<section class="slideshow">
    <div class="slideshow-inner">
        <!-- Slide 1 -->
        <div class="slide active">
            <video class="slide-video" muted autoplay playsinline>
                <source src="{% static 'img/banner1.mp4' %}" type="video/mp4">
            </video>
            <div class="slide-content">
                <h1>Healthcare Reimagined</h1>
                <p>Connect with top doctors, manage appointments, and take control of your health journey with DigiMed.
                </p>
                {% if not user.is_authenticated %}
                <div class="slide-buttons">
                    <a href="{% url 'login' %}" class="btn btn-secondary"
                        style="background: rgba(255,255,255,0.2); color: white; border-color: rgba(255,255,255,0.3);">Login</a>
                    <a href="{% url 'signup' %}" class="btn btn-primary">Get Started</a>
                </div>
                {% else %}
                <div class="slide-buttons">
                    <a href="{% url 'dashboard' %}" class="btn btn-primary">Go to Dashboard</a>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Slide 2 -->
        <div class="slide">
            <video class="slide-video" muted autoplay playsinline>
                <source src="{% static 'img/banner2.mp4' %}" type="video/mp4">
            </video>
            <div class="slide-content">
                <h1>Find Your Specialist</h1>
                <p>Browse through our network of verified healthcare professionals and book appointments instantly.</p>
                {% if not user.is_authenticated %}
                <div class="slide-buttons">
                    <a href="{% url 'login' %}" class="btn btn-secondary"
                        style="background: rgba(255,255,255,0.2); color: white; border-color: rgba(255,255,255,0.3);">Login</a>
                    <a href="{% url 'signup' %}" class="btn btn-primary">Get Started</a>
                </div>
                {% else %}
                <div class="slide-buttons">
                    <a href="{% url 'dashboard' %}" class="btn btn-primary">Browse Doctors</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Navigation Arrows -->
    <button class="slideshow-arrow prev" onclick="changeSlide(-1)">&#10094;</button>
    <button class="slideshow-arrow next" onclick="changeSlide(1)">&#10095;</button>

    <!-- Dot Indicators -->
    <div class="slideshow-dots">
        <button class="slideshow-dot active" onclick="goToSlide(0)"></button>
        <button class="slideshow-dot" onclick="goToSlide(1)"></button>
    </div>
</section>

<script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const dots = document.querySelectorAll('.slideshow-dot');
    const videos = document.querySelectorAll('.slide-video');

    function showSlide(index) {
        if (index >= slides.length) currentSlide = 0;
        if (index < 0) currentSlide = slides.length - 1;

        slides.forEach((slide, i) => {
            slide.classList.remove('active');
            // Pause all videos and reset to beginning
            if (videos[i]) {
                videos[i].pause();
                videos[i].currentTime = 0;
            }
        });
        dots.forEach(dot => dot.classList.remove('active'));

        slides[currentSlide].classList.add('active');
        dots[currentSlide].classList.add('active');

        // Play the current video
        if (videos[currentSlide]) {
            videos[currentSlide].play();
        }
    }

    function changeSlide(direction) {
        currentSlide += direction;
        showSlide(currentSlide);
    }

    function goToSlide(index) {
        currentSlide = index;
        showSlide(currentSlide);
    }

    // Listen for video end to advance to next slide
    videos.forEach((video, index) => {
        video.addEventListener('ended', () => {
            if (index === currentSlide) {
                currentSlide++;
                showSlide(currentSlide);
            }
        });
    });

    // Start the first video
    if (videos[0]) {
        videos[0].play();
    }
</script>
{% endblock %}

{% block content %}
<section class="features"
    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-top: 4rem;">
    <div class="card">
        <h3 style="color: var(--primary);">For Patients</h3>
        <p style="color: var(--text-muted); margin-top: 0.5rem;">
            Find specialists, book appointments tailored to your schedule, and keep track of your medical history
            securely.
        </p>
    </div>
    <div class="card">
        <h3 style="color: var(--secondary);">For Doctors</h3>
        <p style="color: var(--text-muted); margin-top: 0.5rem;">
            Manage your practice efficiently, viewing upcoming appointments and patient records at a glance.
        </p>
    </div>
    <div class="card">
        <h3 style="color: var(--accent);">Secure & Reliable</h3>
        <p style="color: var(--text-muted); margin-top: 0.5rem;">
            Your data is protected with enterprise-grade security. Focus on health, we handle the rest.
        </p>
    </div>
</section>
{% endblock %}